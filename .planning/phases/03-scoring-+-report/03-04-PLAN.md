---
phase: 03-scoring-+-report
plan: 04
type: execute
wave: 2
depends_on:
  - 03-01
files_modified:
  - src/report/charts/ScoreGauge.tsx
  - src/report/charts/ScoreBarChart.tsx
  - src/report/components/ScoreDisplay.tsx
  - src/report/components/ScoreBreakdown.tsx
autonomous: true

must_haves:
  truths:
    - "ScoreGauge component renders SVG circular gauge with score 0-100"
    - "ScoreBarChart renders category scores as horizontal bars"
    - "ScoreDisplay combines gauge with score label and color coding"
    - "ScoreBreakdown shows per-category scores with rule details"
  artifacts:
    - path: "src/report/charts/ScoreGauge.tsx"
      provides: "SVG circular score gauge"
      exports: ["ScoreGauge"]
    - path: "src/report/charts/ScoreBarChart.tsx"
      provides: "Horizontal bar chart for category scores"
      exports: ["ScoreBarChart"]
    - path: "src/report/components/ScoreDisplay.tsx"
      provides: "Combined score visualization with label"
      exports: ["ScoreDisplay"]
    - path: "src/report/components/ScoreBreakdown.tsx"
      provides: "Detailed category score breakdown"
      exports: ["ScoreBreakdown"]
  key_links:
    - from: "ScoreGauge"
      to: "ScoreDisplay"
      via: "composition"
    - from: "ScoreBarChart"
      to: "ScoreBreakdown"
      via: "composition"
    - from: "all components"
      to: "src/types/scoring.ts"
      via: "ScoreResult/CategoryScore imports"
---

<objective>
Create score visualization components using native SVG (consistent with Phase 2 patterns).

Purpose: Build reusable chart components for displaying overall scores (gauge) and category breakdowns (bar chart), plus container components that present scores with appropriate styling and context.

Output: Complete score visualization components ready for integration into the report panel.
</objective>

<execution_context>
@~/.config/opencode/get-shit-done/workflows/execute-plan.md
@~/.config/opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/03-scoring-+-report/03-RESEARCH.md
@.planning/phases/02-sampling-+-metrics/02-03-SUMMARY.md
@src/components/BitrateChart.tsx
@src/types/scoring.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Build score gauge and bar chart SVG components</name>
  <files>
    src/report/charts/ScoreGauge.tsx
    src/report/charts/ScoreBarChart.tsx
  </files>
  <action>
Create SVG chart components following Phase 2 BitrateChart patterns:

**src/report/charts/ScoreGauge.tsx:**
Props interface:
```typescript
interface ScoreGaugeProps {
  score: number // 0-100
  size?: number // default 120
  strokeWidth?: number // default 10
}
```

Implementation:
- Render SVG with viewBox based on size
- Background circle (gray track) with full circumference
- Foreground arc showing score percentage using stroke-dasharray/dashoffset
- Color coding: >=80 green (var(--success)), >=60 yellow (var(--warning)), <60 red (var(--error))
- Centered text showing score number
- Rotate -90deg so arc starts at top
- Use CSS custom properties for colors

**src/report/charts/ScoreBarChart.tsx:**
Props interface:
```typescript
interface ScoreBarChartProps {
  categories: CategoryScore[]
  maxWidth?: number // default 300
  barHeight?: number // default 24
}
```

Implementation:
- Render SVG with horizontal bars for each category
- Y-axis: category names (ladder, codec, segment, metadata)
- X-axis: score 0-100
- Each bar: background track + filled portion showing score
- Color bars same as gauge (green/yellow/red based on score)
- Show score value at end of each bar
- Add grid lines at 25, 50, 75, 100
- Responsive scaling

Both components:
- Handle edge cases (empty data, score 0)
- Use existing CSS variables from App.css
- No external dependencies (native SVG)
  </action>
  <verify>npm run build compiles; components render without errors in dev server</verify>
  <done>ScoreGauge and ScoreBarChart components created with proper SVG rendering</done>
</task>

<task type="auto">
  <name>Task 2: Build score display and breakdown components</name>
  <files>
    src/report/components/ScoreDisplay.tsx
    src/report/components/ScoreBreakdown.tsx
  </files>
  <action>
Create container components for score presentation:

**src/report/components/ScoreDisplay.tsx:**
Props interface:
```typescript
interface ScoreDisplayProps {
  score: number
  showLabel?: boolean // default true
  size?: 'small' | 'medium' | 'large' // default 'medium'
}
```

Implementation:
- Render ScoreGauge with appropriate size based on size prop
- Show score label below gauge ("Excellent", "Good", "Fair", "Poor") based on ranges:
  - 90-100: "Excellent"
  - 80-89: "Good"
  - 60-79: "Fair"
  - <60: "Poor"
- Apply color-coded CSS classes for styling
- Container div with className for CSS targeting

**src/report/components/ScoreBreakdown.tsx:**
Props interface:
```typescript
interface ScoreBreakdownProps {
  categories: CategoryScore[]
  showRules?: boolean // default false, expand to show individual rules
}
```

Implementation:
- Render ScoreBarChart for category overview
- Below chart, list each category with:
  - Category name and score
  - Expandable section (use native &lt;details&gt;/&lt;summary&gt;) showing individual rules
  - For each rule: name, score, passed status, reason
- Color-code category headers by score
- Use consistent styling with other result sections

Import from `../charts/ScoreGauge`, `../charts/ScoreBarChart`, `../../types/scoring`.
  </action>
  <verify>npm run build compiles; components accept props and render correctly</verify>
  <done>ScoreDisplay and ScoreBreakdown components created with proper composition</done>
</task>

</tasks>

<verification>
- [ ] ScoreGauge renders circular SVG gauge with correct arc for score
- [ ] ScoreBarChart renders horizontal bars for each category
- [ ] ScoreDisplay combines gauge with score label
- [ ] ScoreBreakdown shows category bars and expandable rule details
- [ ] Color coding follows score ranges (green >=80, yellow >=60, red <60)
- [ ] All components use CSS custom properties
- [ ] Build succeeds with no TypeScript errors
</verification>

<success_criteria>
- ScoreGauge visually represents 0-100 score as circular arc
- ScoreBarChart shows category comparison
- ScoreDisplay provides complete score presentation
- ScoreBreakdown offers detailed drill-down
- Components follow Phase 2 SVG patterns
</success_criteria>

<output>
After completion, create `.planning/phases/03-scoring-+-report/03-04-SUMMARY.md`
</output>
