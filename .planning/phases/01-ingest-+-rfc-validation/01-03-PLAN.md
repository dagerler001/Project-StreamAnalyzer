---
phase: 01-ingest-+-rfc-validation
plan: 03
type: execute
wave: 3
depends_on: ["01-02"]
files_modified:
  - src/App.tsx
  - src/App.css
  - src/components/SegmentedControl.tsx
  - src/components/InputPanel.tsx
  - src/hooks/usePlaylistAnalysis.ts
  - src/components/ValidationPanel.tsx
  - src/components/ClassificationBadges.tsx
  - src/components/LadderTable.tsx
autonomous: true
must_haves:
  truths:
    - "User can submit a M3U8 URL, channel/VOD ID, or local M3U8 file and trigger analysis."
    - "User sees validation issues with severity and fix hints when playlist rules are violated."
    - "User sees playlist classification for master/variant and live/VOD."
    - "User sees an ABR ladder table with bitrate, resolution, and codecs extracted from the playlist."
  artifacts:
    - path: "src/components/InputPanel.tsx"
      provides: "Input type selector + analyze action"
    - path: "src/hooks/usePlaylistAnalysis.ts"
      provides: "Ingest pipeline from input to analysis result"
    - path: "src/components/ValidationPanel.tsx"
      provides: "Validation feedback UI"
    - path: "src/components/ClassificationBadges.tsx"
      provides: "Playlist classification display"
    - path: "src/components/LadderTable.tsx"
      provides: "Ladder table UI"
  key_links:
    - from: "src/components/InputPanel.tsx"
      to: "src/hooks/usePlaylistAnalysis.ts"
      via: "onAnalyze callback"
      pattern: "onAnalyze"
    - from: "src/hooks/usePlaylistAnalysis.ts"
      to: "src/analysis/playlist/parseM3U8.ts"
      via: "parseM3U8"
      pattern: "parseM3U8"
    - from: "src/components/ValidationPanel.tsx"
      to: "AnalysisResult.validation.issues"
      via: "map render"
      pattern: "issues\.map"
    - from: "src/components/LadderTable.tsx"
      to: "AnalysisResult.ladder"
      via: "map render"
      pattern: "ladder\.(video|audio)"
---

<objective>
Deliver the Phase 1 ingest UI and results rendering wired to the analysis core.

Purpose: Let users submit playlists and immediately see validation, classification, and ladder outputs.
Output: Interactive UI with input controls and results panels.
</objective>

<execution_context>
@~/.config/opencode/get-shit-done/workflows/execute-plan.md
@~/.config/opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-ingest-+-rfc-validation/01-CONTEXT.md
@.planning/phases/01-ingest-+-rfc-validation/01-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Build the ingest input panel</name>
  <files>src/components/SegmentedControl.tsx, src/components/InputPanel.tsx, src/App.tsx</files>
  <action>
    Implement an input-type selector with three options: URL (default), Channel/VOD ID, and Local File.
    Provide dedicated fields for each input type and an explicit Analyze button to submit.
    Use a segmented-control style selector and keep the URL input focused by default.
  </action>
  <verify>npm run build</verify>
  <done>Input panel renders tabs for URL/ID/File with an Analyze button and correct field switching.</done>
</task>

<task type="auto">
  <name>Task 2: Wire ingest inputs to the analysis pipeline</name>
  <files>src/hooks/usePlaylistAnalysis.ts, src/App.tsx</files>
  <action>
    Create a `usePlaylistAnalysis` hook that accepts the selected input type and value, then:
    - URL: fetch playlist text directly.
    - Channel/VOD ID: resolve via mock resolver, then fetch playlist text.
    - Local file: read text via File.text().
    Pipe the text through parseM3U8, validatePlaylist, classifyPlaylist, and extractLadder.
    Surface errors (fetch/resolve failures) in state and keep validation issues even when errors exist.
  </action>
  <verify>npm run build</verify>
  <done>Analyze triggers the ingest pipeline and updates App state with validation, classification, and ladder results.</done>
</task>

<task type="auto">
  <name>Task 3: Render validation, classification, and ladder results</name>
  <files>src/components/ValidationPanel.tsx, src/components/ClassificationBadges.tsx, src/components/LadderTable.tsx, src/App.tsx, src/App.css</files>
  <action>
    Add results components that follow the Phase 1 UI decisions:
    - Validation panel shows issues with Error/Warning/Info severity badges and short fix hints.
    - Classification badges show Master/Variant and Live/VOD with icon + label styling.
    - Ladder table groups Video vs Audio variants, includes bitrate, resolution, codecs, bandwidth/avg bitrate/FPS columns when present, and sorts by descending bitrate.
    Show results even when validation has errors, but clearly flag that outputs are unreliable.
  </action>
  <verify>npm run build</verify>
  <done>Results panel displays validation issues, playlist classification, and ladder table for a parsed playlist.</done>
</task>

</tasks>

<verification>
`npm run build` completes without errors.
</verification>

<success_criteria>
Users can submit a playlist input and view validation feedback, classification badges, and a ladder baseline in the UI.
</success_criteria>

<output>
After completion, create `.planning/phases/01-ingest-+-rfc-validation/01-03-SUMMARY.md`
</output>
